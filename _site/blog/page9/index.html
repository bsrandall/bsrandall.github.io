<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Blog &middot; No Excuses CCIE
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/main.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"> </script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });
  </script>
  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="sidebar-personal-info">
      <div class="sidebar-personal-info-section">
        <a href="http://gravatar.com/">
          <img src="http://www.gravatar.com/avatar/?s=350" title="View on Gravatar" alt="View on Gravatar" />
        </a>
      </div>
      <div class="sidebar-personal-info-section">
        <p>A dedicated network professional, working hard every day for my wife and child.</p>
      </div>
      
    </div>
  </div>

  <nav class="sidebar-nav">
    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="/blog/">
          Home
        </a>

        
      </span>

    
      
      
      

      

      <span class="foldable">
        <a class="sidebar-nav-item " href="/blog/">
          Blog
        </a>

        
          
            
            
            
              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/">
                Categories
              </a>
          
        
          
            
            
            
              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/tags/">
                Tags
              </a>
          
        
      </span>

    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="/about/">
          About
        </a>

        
      </span>

    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="http://bsrandall.github.io/">
          Github Project
        </a>

        
      </span>

    

    <span class="sidebar-nav-item">Currently v1.0.0</span>
  </nav>

</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home" title="No Excuses CCIE">
              <img class="masthead-logo" src="/public/logo.png"/>
            </a>
            <small>My professional journey towards CCIE Route & Switch</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/layer%202/2017/03/30/Smartport-Macros/">
        Smartport Macros
      </a>
    </h1>

    <span class="post-date">30 Mar 2017</span>
     | 
    
    <a href="/blog/tags/#knowledge" class="post-tag">knowledge</a>
    
    

    <article>
      <p>Smartport Macros are used to define a well-known template of configuration onto multiple interfaces. Several Smartport Macros come predefined in the switch. To see them, use <code class="highlighter-rouge">show parser macro</code>. To expand one of the macros use <code class="highlighter-rouge">show parser macro name ___________</code>.</p>

<p>This is the old style of configuring switchport macros:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(conf)# macro name VLAN146
Enter macro commands one per line. End with the character '@'.
switchport mode access
switchport access vlan 146
spanning-tree bpdufilter enable
@
SW1(conf)\#
</code></pre>
</div>
<p>The # symbol can be used at the beginning of a line to designate comments. Then to apply the macro to an interface or interface range:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(conf)# interface range gig0/1-2
SW1(conf-if-range)# macro apply VLAN146
SW1(conf-if-range)# exit
</code></pre>
</div>

<p>The modern style to define a switchport macro is here:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(conf)# define interface-range VLAN146 gig0/1-2
SW1(conf)# interface range macro VLAN146
SW1(conf-if-range)# switchport mode access
SW1(conf-if-range)# switchport access vlan 146
SW1(conf-if-range)# spanning-tree bpdufilter enable
SW1(conf-if-range)# exit
SW1(conf)# 
</code></pre>
</div>

    <article>
    <div class="post-more">
      
      <a href="/layer%202/2017/03/30/Smartport-Macros/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/layer%202/2017/03/30/Smartport-Macros/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/layer%202/2017/03/30/Private-VLANs/">
        Private VLANs
      </a>
    </h1>

    <span class="post-date">30 Mar 2017</span>
     | 
    
    <a href="/blog/tags/#knowledge" class="post-tag">knowledge</a>
    
    

    <article>
      <p>Protect Ports (discussed earlier) are a nice security feature of Cisco switches. When two ports are protected, they are not allowed to have direct communication with each other. But one limitation of protected ports is that they are only locally significant, so there is no way for protected ports to exist on different switches and follow the protection rules.</p>

<p>The Private VLAN feature was created to solve this limitation. Private VLANs are more complex and can span multiple physical switches. Private VLANs split what would normally be a single broadcast domain defined by a single VLAN into multiple isolated broadcast subdomains, that are defined by a primary VLAN and its secondary VLANs. In essence it allows us to create VLANs inside VLANs, and is not un-similar to the concept of Confederations in BGP.</p>

<p>Private VLANs are used to increase security. We most often see them in a shared color facility. This allows the color provider to have the customers exist on the same VLAN (and thus the same subnet), without allowing the different customers to communicate directly with each other.</p>

<p>One pitfall you have to remember with Private VLANs is that it requires VTP to either be in Transparent mode or to be off.</p>

<p>There is some terminology to remember when dealing with Private VLANs:</p>
<ul>
  <li><em>Promiscuous ports</em> are allowed to talk to all other ports within the primary VLAN</li>
  <li><em>Isolated ports</em> are only allowed to talk with promiscuous ports</li>
  <li><em>Community ports</em> are allowed to talk with other ports in their own community as well as any promiscuous ports,  but they are not allowed to talk to ports in other communities</li>
</ul>

<p>The configuration steps are a little unnatural as well. The port roles are defined by the interface’s association to a primary VLAN and one or more secondary VLANs. First the secondary VLANs are created and defined as either community or isolated. Then the primary VLAN is defined, and the secondary VLANs are associated with the primary VLAN.</p>

<p>Here is an example configuration with VLAN 500 as the primary VLAN, 501 a secondary community VLAN, and VLAN 502 a secondary isolated VLAN. Ports FastEthernet0/1 and FastEthernet0/2 are associated to VLAN 501, while FastEthernet03 and FastEthernet0/4 are associated with the secondary isolated VLAN 502.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# vtp mode transparent
SW1(config)# vlan 501
SW1(config-vlan)# private-vlan community
SW1(config-vlan)# vlan 500
SW1(config-vlan)# private-vlan primary
SW1(config-vlan)# private-vlan association add 501
</code></pre>
</div>

<p>Next, let’s go ahead and associate FastEthernet0/1 and FastEthernet0/2 to the 501 Secondary Community we just created:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# interface range fa0/1-2
SW1(config-if-range)# switchport mode private-vlan host
SW1(config-if-range)# switchport private-vlan host-association 500 501
</code></pre>
</div>

<p>Now, we can go ahead and configure FastEthernet0/24 as a promiscuous port.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# interface fa0/24
SW1(config-if)# switchport mode private-vlan promiscuous
SW1(config-if)# switchport private-vlan mapping 500 501
</code></pre>
</div>

<p>Now we turn our attention to the creation of the isolated VLAN, VLAN 502.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# vlan 502
SW1(config-vlan)# private-vlan isolated
SW1(config-vlan)# vlan 500
SW1(config-vlan)# private-vlan primary
SW1(config-vlan)# private-vlan association add 502
</code></pre>
</div>

<p>Now we must associate our interfaces:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# interface range fa0/3-4
SW1(config-if-range)# switchport mode private-vlan host
SW1(config-if-range)# switchport private-vlan host-association 500 502
</code></pre>
</div>

<p>And finally, we must add another association for our promiscuous port:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# interface fa0/24
SW1(config-if)# switchport mode private-vlan promiscuous
SW1(config-if)# switchport private-vlan mapping 500 502
</code></pre>
</div>

<p>One great way to test your Private VLAN setup is to send a single ping to the broadcast address with <code class="highlighter-rouge">ping 255.255.255.255 repeat 1</code>.  The replies will only be from the hosts in your broadcast domain.</p>

<p>One other thing to note. If you are configuring a Primary VLAN SVI to operate with secondary private VLANs, you need to map the secondary VLANs onto the SVI as in the following:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>`SW1(config)# interface Vlan 100
SW1(config-if)# private-vlan mapping 1000,2000
</code></pre>
</div>
<p>`</p>

    <article>
    <div class="post-more">
      
      <a href="/layer%202/2017/03/30/Private-VLANs/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/layer%202/2017/03/30/Private-VLANs/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/layer%202/2017/03/29/Protected-Port/">
        Protected Port (PVLAN)
      </a>
    </h1>

    <span class="post-date">29 Mar 2017</span>
     | 
    
    <a href="/blog/tags/#knowledge" class="post-tag">knowledge</a>
    
    

    <article>
      <p>The protected port, also known as PVLAN edge, is a security feature used to prevent traffic from being directly exchanged at Layer 2 between two or more hosts that are within the same VLAN. Protected ports only have local switch significance. A protected port does not forward any traffic (unicast, multicast, or broadcast) to any other protected port in the same switch. If you need to pass traffic between protected ports, the only possible way is through a L3 device.</p>

<p>By default, all switch ports are unprotected. The configuration is as simple as below:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# interface gig0/1
SW1(config-if)# switchport protected
</code></pre>
</div>

    <article>
    <div class="post-more">
      
      <a href="/layer%202/2017/03/29/Protected-Port/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/layer%202/2017/03/29/Protected-Port/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/spanning%20tree/2017/03/29/STP-Loop-Guard/">
        Spanning Tree Loop Guard
      </a>
    </h1>

    <span class="post-date">29 Mar 2017</span>
     | 
    
    <a href="/blog/tags/#knowledge" class="post-tag">knowledge</a>
    
    

    <article>
      <p>Loop Guard is a Spanning Tree feature that was added to prevent loops from forming due to hardware issues or STP software problems. A Spanning Tree loop occurs when a port that was previously in the blocking state is erroneously  transitioned to the Forwarding state.</p>

<p>When a non-designated port stops receiving BPDUs, it will eventually transition itself to a designated port and begin forwarding BPDUs. Loop Guard works by preventing that non-designated port from transitioning to a forwarding state. Instead, it transitions the port to STP loop-inconsistent blocking state. So Loop Guard prevents a non-designated port from becoming a designated port, while Root Guard prevents a designated port from transitioning to a Root Port.</p>

<p>Loop Guard is very similar to UDLD, but Loop Guard uses STP BPDUs to determine if there is a loop.</p>

<p>Loop Guard is enabled on a per-port basis with the interface subcommand <code class="highlighter-rouge">spanning-tree guard loop</code>. To be completely effective, Loop Guard should be enabled on <em>all</em> non-designated ports, including root ports and alternate ports. Loop Guard can also be enabled globally with the <code class="highlighter-rouge">spanning-tree loopguard default</code> global configuration command. You can then disable Loop Guard on a per-port basis with <code class="highlighter-rouge">no spanning-tree guard loop</code>.</p>


    <article>
    <div class="post-more">
      
      <a href="/spanning%20tree/2017/03/29/STP-Loop-Guard/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/spanning%20tree/2017/03/29/STP-Loop-Guard/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/spanning%20tree/2017/03/28/STP-Root-Guard/">
        Spanning Tree Root Guard
      </a>
    </h1>

    <span class="post-date">28 Mar 2017</span>
     | 
    
    <a href="/blog/tags/#knowledge" class="post-tag">knowledge</a>
    
    

    <article>
      <p>Root Guard is an enhancement to STP developed by Cisco. One issue with standard STP is that there is no way to ensure root bridge placement within the network. Even if you set a switch’s bridge priority to 0, another switch can come behind it with a priority of 0 and a lower MAC address and immediately take over the Root Bridge role.</p>

<p>Root Guard is enabled on a per port basis. Root Guard ensures that the port on which it is configured remains a designated port. If the bridge receives superior BPDUs on that designated port, Root Guard moves the port to root-inconsistent state, which is effectively equivalent to the STP listening state so no frames are forwarded.</p>

<p>The difference between BPDU Guard and Root Guard is that Root Guard allows the port to participate in STP, so long as the port does not receive a <em>superior</em> BPDU. With BPDU Guard, <em>any</em> BPDU will put the port into an err-disabled state.</p>

<p>Again, Root Guard is enabled on a per interface basis as below.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>SW1(config)# interface gig0/1
SW!(config-if)# spanning-tree rootguard
</code></pre>
</div>

<p>The Cisco explanation is located <a href="http://www.cisco.com/c/en/us/support/docs/lan-switching/spanning-tree-protocol/10588-74.html">here</a>.</p>


    <article>
    <div class="post-more">
      
      <a href="/spanning%20tree/2017/03/28/STP-Root-Guard/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/spanning%20tree/2017/03/28/STP-Root-Guard/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page10">Older</a>
  
  
    
      <a class="pagination-item newer" href="/blog/page8">Newer</a>
    
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if (target === toggle) {
            checkbox.checked = !checkbox.checked;
            e.preventDefault();
          } else if (checkbox.checked && !sidebar.contains(target)) {
            /* click outside the sidebar when sidebar is open */
            checkbox.checked = false;
          }
        }, false);
      })(document);
    </script>
    
    <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-00000000-1', 'auto');
ga('send', 'pageview');
    </script>
    
  </body>
  
  <script id="dsq-count-scr" src="//your_short_name.disqus.com/count.js" async></script>
  
</html>
